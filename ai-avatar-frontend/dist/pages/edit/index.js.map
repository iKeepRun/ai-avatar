{"version":3,"file":"pages/edit/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC7NA;AACA;AAAA;AAOA;AAAA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AAEA;;;;;;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://ai-avatar-frontend/./src/pages/edit/index.tsx?5053","webpack://ai-avatar-frontend/._src_components_ColorPicker_index.tsx","webpack://ai-avatar-frontend/._src_pages_edit_index.tsx"],"sourcesContent":["import _defineProperty from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { useState, useEffect } from 'react';\nimport { View, Image, Text, Button, ScrollView, Slider } from '@tarojs/components';\nimport Taro from '@tarojs/taro';\nimport { observer } from 'mobx-react';\nimport { useStore } from '@/stores';\nimport { avatarApi } from '@/services/api';\nimport ColorPicker from '@/components/ColorPicker';\nimport './index.scss';\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nvar EditPage = function EditPage() {\n  var _useStore = useStore(),\n    avatarStore = _useStore.avatarStore;\n  var _useState = useState('basic'),\n    _useState2 = _slicedToArray(_useState, 2),\n    activeTab = _useState2[0],\n    setActiveTab = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState({\n      faceRatio: 50,\n      hairColor: '#000000',\n      backgroundComplexity: 30\n    }),\n    _useState6 = _slicedToArray(_useState5, 2),\n    params = _useState6[0],\n    setParams = _useState6[1];\n  useEffect(function () {\n    startPreview();\n  }, [params]);\n  var startPreview = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var res;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setLoading(true);\n            _context.next = 4;\n            return avatarApi.updateParams(avatarStore.taskId, params);\n          case 4:\n            res = _context.sent;\n            avatarStore.setPreviewImage(res.data.previewUrl);\n            _context.next = 11;\n            break;\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](0);\n            Taro.showToast({\n              title: '预览失败',\n              icon: 'none'\n            });\n          case 11:\n            _context.prev = 11;\n            setLoading(false);\n            return _context.finish(11);\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 8, 11, 14]]);\n    }));\n    return function startPreview() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var handleParamChange = function handleParamChange(key, value) {\n    setParams(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, _defineProperty({}, key, value));\n    });\n  };\n  var handleGenerate = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setLoading(true);\n            _context2.next = 4;\n            return avatarApi.generate(avatarStore.taskId, params);\n          case 4:\n            Taro.navigateTo({\n              url: \"/pages/result/index?taskId=\".concat(avatarStore.taskId)\n            });\n            _context2.next = 10;\n            break;\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](0);\n            Taro.showToast({\n              title: '生成失败',\n              icon: 'none'\n            });\n          case 10:\n            _context2.prev = 10;\n            setLoading(false);\n            return _context2.finish(10);\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[0, 7, 10, 13]]);\n    }));\n    return function handleGenerate() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxs(View, {\n    className: \"edit-page\",\n    children: [/*#__PURE__*/_jsxs(View, {\n      className: \"preview-area\",\n      children: [/*#__PURE__*/_jsx(Image, {\n        className: \"preview-image\",\n        src: avatarStore.previewImage || avatarStore.originalImage,\n        mode: \"aspectFill\"\n      }), loading && /*#__PURE__*/_jsxs(View, {\n        className: \"loading-mask\",\n        children: [/*#__PURE__*/_jsx(View, {\n          className: \"loading-icon\"\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"loading-text\",\n          children: \"\\u9884\\u89C8\\u751F\\u6210\\u4E2D...\"\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(View, {\n      className: \"edit-area\",\n      children: [/*#__PURE__*/_jsxs(View, {\n        className: \"tab-bar\",\n        children: [/*#__PURE__*/_jsx(View, {\n          className: \"tab-item \".concat(activeTab === 'basic' ? 'active' : ''),\n          onClick: function onClick() {\n            return setActiveTab('basic');\n          },\n          children: \"\\u57FA\\u7840\\u8C03\\u6574\"\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"tab-item \".concat(activeTab === 'advanced' ? 'active' : ''),\n          onClick: function onClick() {\n            return setActiveTab('advanced');\n          },\n          children: \"\\u9AD8\\u7EA7\\u8C03\\u6574\"\n        })]\n      }), /*#__PURE__*/_jsx(ScrollView, {\n        scrollY: true,\n        className: \"params-list\",\n        children: activeTab === 'basic' && /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsxs(View, {\n            className: \"param-item\",\n            children: [/*#__PURE__*/_jsxs(View, {\n              className: \"param-label\",\n              children: [/*#__PURE__*/_jsx(Text, {\n                children: \"\\u4E94\\u5B98\\u6BD4\\u4F8B\"\n              }), /*#__PURE__*/_jsxs(Text, {\n                className: \"param-value\",\n                children: [params.faceRatio, \"%\"]\n              })]\n            }), /*#__PURE__*/_jsx(Slider, {\n              value: params.faceRatio,\n              min: 0,\n              max: 100,\n              onChange: function onChange(e) {\n                return handleParamChange('faceRatio', e.detail.value);\n              }\n            })]\n          }), /*#__PURE__*/_jsxs(View, {\n            className: \"param-item\",\n            children: [/*#__PURE__*/_jsx(View, {\n              className: \"param-label\",\n              children: \"\\u53D1\\u8272\"\n            }), /*#__PURE__*/_jsx(ColorPicker, {\n              color: params.hairColor,\n              onChange: function onChange(color) {\n                return handleParamChange('hairColor', color);\n              }\n            })]\n          }), /*#__PURE__*/_jsxs(View, {\n            className: \"param-item\",\n            children: [/*#__PURE__*/_jsxs(View, {\n              className: \"param-label\",\n              children: [/*#__PURE__*/_jsx(Text, {\n                children: \"\\u80CC\\u666F\\u590D\\u6742\\u5EA6\"\n              }), /*#__PURE__*/_jsxs(Text, {\n                className: \"param-value\",\n                children: [params.backgroundComplexity, \"%\"]\n              })]\n            }), /*#__PURE__*/_jsx(Slider, {\n              value: params.backgroundComplexity,\n              min: 0,\n              max: 100,\n              onChange: function onChange(e) {\n                return handleParamChange('backgroundComplexity', e.detail.value);\n              }\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"action-bar\",\n        children: [/*#__PURE__*/_jsx(Button, {\n          className: \"reset-btn\",\n          onClick: function onClick() {\n            return setParams({\n              faceRatio: 50,\n              hairColor: '#000000',\n              backgroundComplexity: 30\n            });\n          },\n          children: \"\\u91CD\\u7F6E\"\n        }), /*#__PURE__*/_jsx(Button, {\n          className: \"generate-btn\",\n          loading: loading,\n          onClick: handleGenerate,\n          children: \"\\u751F\\u6210\\u5934\\u50CF\"\n        })]\n      })]\n    })]\n  });\n};\nexport default observer(EditPage);","import { FC } from 'react'\r\nimport { View } from '@tarojs/components'\r\nimport './index.scss'\r\n\r\ninterface Props {\r\n  color: string\r\n  onChange: (color: string) => void\r\n}\r\n\r\nconst ColorPicker: FC<Props> = ({ color, onChange }) => {\r\n  return (\r\n    <View className='color-picker'>\r\n      <View \r\n        className='color-preview'\r\n        style={{ backgroundColor: color }}\r\n        onClick={() => {\r\n          // 这里应该打开颜色选择器，但微信小程序没有原生的颜色选择器\r\n          // 可以考虑使用第三方组件或自定义实现\r\n          onChange('#000000')\r\n        }}\r\n      />\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ColorPicker ","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/edit/index!./index.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pages/edit/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}