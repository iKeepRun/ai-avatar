{"version":3,"file":"pages/index/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://ai-avatar-frontend/./src/pages/index/index.tsx?acc1","webpack://ai-avatar-frontend/._src_pages_index_index.tsx"],"sourcesContent":["import _regeneratorRuntime from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { View, Image, Button } from '@tarojs/components';\nimport Taro, { useLoad } from '@tarojs/taro';\nimport { useState } from 'react';\nimport { uploadImage } from '../../services/api';\nimport './index.scss';\n\n// 导入图片\nimport logo from '@/assets/images/logo.png';\nimport upload from '@/assets/images/upload.png';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Index() {\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    imageUrl = _useState2[0],\n    setImageUrl = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    error = _useState6[0],\n    setError = _useState6[1];\n  useLoad(function () {\n    // 检查登录状态\n    var token = Taro.getStorageSync('token');\n    if (!token) {\n      Taro.navigateTo({\n        url: '/pages/login/index'\n      });\n    }\n  });\n  var handleChooseImage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var res;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return Taro.chooseImage({\n              count: 1,\n              sizeType: ['compressed'],\n              sourceType: ['album', 'camera']\n            });\n          case 3:\n            res = _context.sent;\n            if (res.tempFilePaths && res.tempFilePaths[0]) {\n              setImageUrl(res.tempFilePaths[0]);\n              setError('');\n            }\n            _context.next = 11;\n            break;\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            console.error('选择图片失败:', _context.t0);\n            setError('选择图片失败，请重试');\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n    return function handleChooseImage() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var handleNext = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var uploadRes;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            if (imageUrl) {\n              _context2.next = 3;\n              break;\n            }\n            setError('请先选择图片');\n            return _context2.abrupt(\"return\");\n          case 3:\n            setLoading(true);\n            setError('');\n            _context2.prev = 5;\n            _context2.next = 8;\n            return uploadImage(imageUrl);\n          case 8:\n            uploadRes = _context2.sent;\n            // 跳转到风格选择页面\n            Taro.navigateTo({\n              url: \"/pages/style/index?imageId=\".concat(uploadRes.data.imageId)\n            });\n            _context2.next = 16;\n            break;\n          case 12:\n            _context2.prev = 12;\n            _context2.t0 = _context2[\"catch\"](5);\n            console.error('上传失败:', _context2.t0);\n            setError('上传失败，请重试');\n          case 16:\n            _context2.prev = 16;\n            setLoading(false);\n            return _context2.finish(16);\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[5, 12, 16, 19]]);\n    }));\n    return function handleNext() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxs(View, {\n    className: \"index-page\",\n    children: [/*#__PURE__*/_jsxs(View, {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsx(Image, {\n        className: \"logo\",\n        src: logo\n      }), /*#__PURE__*/_jsx(View, {\n        className: \"title\",\n        children: \"AI\\u5934\\u50CF\\u751F\\u6210\\u5668\"\n      })]\n    }), /*#__PURE__*/_jsxs(View, {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsx(View, {\n        className: \"upload-section\",\n        children: imageUrl ? /*#__PURE__*/_jsx(Image, {\n          className: \"preview-image\",\n          src: imageUrl,\n          mode: \"aspectFit\"\n        }) : /*#__PURE__*/_jsxs(View, {\n          className: \"upload-placeholder\",\n          onClick: handleChooseImage,\n          children: [/*#__PURE__*/_jsx(Image, {\n            className: \"upload-icon\",\n            src: upload\n          }), /*#__PURE__*/_jsx(View, {\n            className: \"upload-text\",\n            children: \"\\u70B9\\u51FB\\u4E0A\\u4F20\\u7167\\u7247\"\n          })]\n        })\n      }), error && /*#__PURE__*/_jsx(View, {\n        className: \"error-message\",\n        children: error\n      }), /*#__PURE__*/_jsx(Button, {\n        className: \"next-button\",\n        loading: loading,\n        disabled: !imageUrl || loading,\n        onClick: handleNext,\n        children: \"\\u4E0B\\u4E00\\u6B65\"\n      })]\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"footer\",\n      children: /*#__PURE__*/_jsxs(View, {\n        className: \"tips\",\n        children: [/*#__PURE__*/_jsx(View, {\n          className: \"tip-item\",\n          children: \"\\u652F\\u6301jpg\\u3001png\\u683C\\u5F0F\"\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"tip-item\",\n          children: \"\\u5EFA\\u8BAE\\u4E0A\\u4F20\\u6E05\\u6670\\u7684\\u6B63\\u9762\\u7167\\u7247\"\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"tip-item\",\n          children: \"\\u7167\\u7247\\u5927\\u5C0F\\u4E0D\\u8D85\\u8FC75MB\"\n        })]\n      })\n    })]\n  });\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/index/index!./index.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pages/index/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}