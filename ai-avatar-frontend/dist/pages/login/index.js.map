{"version":3,"file":"pages/login/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://ai-avatar-frontend/./src/pages/login/index.tsx?84ae","webpack://ai-avatar-frontend/._src_pages_login_index.tsx"],"sourcesContent":["import _regeneratorRuntime from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/_code/ai-avatar/ai-avatar-mini-program/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { View, Image, Button } from '@tarojs/components';\nimport Taro from '@tarojs/taro';\nimport { useState } from 'react';\nimport { userApi } from '../../services/api';\nimport './index.scss';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Login() {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    loading = _useState2[0],\n    setLoading = _useState2[1];\n  var handleLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _yield$Taro$login, code, res, userInfo;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setLoading(true);\n\n            // 获取微信登录code\n            _context.next = 4;\n            return Taro.login();\n          case 4:\n            _yield$Taro$login = _context.sent;\n            code = _yield$Taro$login.code;\n            _context.next = 8;\n            return userApi.login(code);\n          case 8:\n            res = _context.sent;\n            // 保存token\n            Taro.setStorageSync('token', res.data.token);\n\n            // 获取用户信息\n            _context.next = 12;\n            return userApi.getProfile();\n          case 12:\n            userInfo = _context.sent;\n            Taro.setStorageSync('userInfo', userInfo.data);\n\n            // 返回首页\n            Taro.switchTab({\n              url: '/pages/index/index'\n            });\n            _context.next = 21;\n            break;\n          case 17:\n            _context.prev = 17;\n            _context.t0 = _context[\"catch\"](0);\n            console.error('登录失败:', _context.t0);\n            Taro.showToast({\n              title: '登录失败，请重试',\n              icon: 'none'\n            });\n          case 21:\n            _context.prev = 21;\n            setLoading(false);\n            return _context.finish(21);\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 17, 21, 24]]);\n    }));\n    return function handleLogin() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxs(View, {\n    className: \"login-page\",\n    children: [/*#__PURE__*/_jsxs(View, {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsx(Image, {\n        className: \"logo\",\n        src: \"./assets/images/logo.svg\"\n      }), /*#__PURE__*/_jsx(View, {\n        className: \"title\",\n        children: \"AI\\u5934\\u50CF\\u751F\\u6210\\u5668\"\n      }), /*#__PURE__*/_jsx(View, {\n        className: \"subtitle\",\n        children: \"\\u4E00\\u952E\\u751F\\u6210\\u4F60\\u7684\\u4E13\\u5C5E\\u5934\\u50CF\"\n      })]\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"content\",\n      children: /*#__PURE__*/_jsx(Button, {\n        className: \"login-button\",\n        loading: loading,\n        onClick: handleLogin,\n        children: \"\\u5FAE\\u4FE1\\u4E00\\u952E\\u767B\\u5F55\"\n      })\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"footer\",\n      children: /*#__PURE__*/_jsxs(View, {\n        className: \"tips\",\n        children: [/*#__PURE__*/_jsx(View, {\n          className: \"tip-item\",\n          children: \"\\u767B\\u5F55\\u540E\\u5373\\u53EF\\u4F7F\\u7528\\u5B8C\\u6574\\u529F\\u80FD\"\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"tip-item\",\n          children: \"\\u6211\\u4EEC\\u627F\\u8BFA\\u4FDD\\u62A4\\u60A8\\u7684\\u9690\\u79C1\\u5B89\\u5168\"\n        })]\n      })\n    })]\n  });\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/login/index!./index.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pages/login/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}