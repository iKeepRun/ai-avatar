{"version":3,"file":"pages/style/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://ai-avatar-frontend/./src/pages/style/index.tsx?99ae","webpack://ai-avatar-frontend/._src_pages_style_index.tsx"],"sourcesContent":["import _regeneratorRuntime from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/_code/ai-avatar/ai-avatar-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport Taro from '@tarojs/taro';\nimport { useState } from 'react';\nimport { View, Image, Text } from '@tarojs/components';\nimport './index.scss';\nimport { useStore } from '@/stores';\nimport { generateAvatar } from '@/services/api';\n\n// 导入图标\n\nimport iconStar from '@/assets/images/star.png';\nimport iconCrown from '@/assets/images/crown.png';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\n// 风格映射\n// const styleMap = [\n//   { name: \"复古漫画\", icon: './assets/images/style-comic.png' },\n//   { name: \"3D童话\", icon: './assets/images/style-fairytale.png' },\n//   { name: \"二次元\", icon: './assets/images/style-anime.png' },\n//   { name: \"小清新\", icon: './assets/images/style-light.png' },\n//   { name: \"未来科技\", icon: './assets/images/style-future.png' },\n//   { name: \"国画古风\", icon: './assets/images/style-chinese.png' },\n//   { name: \"将军百战\", icon: './assets/images/style-warrior.png' },\n//   { name: \"炫彩卡通\", icon: './assets/images/style-cartoon.png' },\n//   { name: \"清雅国风\", icon: './assets/images/style-chinese.png' },\n//   { name: \"喜迎新年\", icon: './assets/images/style-newyear.png' },\n// ]\nvar styleMap = [{\n  name: \"复古漫画\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"3D童话\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"二次元\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"小清新\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"未来科技\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"国画古风\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"将军百战\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"炫彩卡通\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"清雅国风\",\n  icon: './assets/images/cartoon.png'\n}, {\n  name: \"喜迎新年\",\n  icon: './assets/images/cartoon.png'\n}];\nexport default function StylePage() {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    loading = _useState2[0],\n    setLoading = _useState2[1];\n  var _useStore = useStore(),\n    avatarStore = _useStore.avatarStore,\n    userStore = _useStore.userStore;\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    resultImage = _useState4[0],\n    setResultImage = _useState4[1];\n\n  // const handleSelect = async (styleId) => {\n  //   try {\n  //     setLoading(true)\n  //     // 调用API更新风格选择\n  //     await avatarApi.updateStyle(taskId, styleId)\n  //     // 保存到store\n  //     avatarStore.setCurrentStyle(styleId)\n  //     // 跳转到结果页\n  //     Taro.navigateTo({ url: `/pages/result/index?taskId=${taskId}` })\n  //   } catch (error) {\n  //     Taro.showToast({ title: '选择风格失败', icon: 'none' })\n  //   } finally {\n  //     setLoading(false)\n  //   }\n  // }\n\n  var handleSelect = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(style) {\n      var res, taskId;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setLoading(true);\n            // 调用生成头像的后端接口\n            _context.next = 4;\n            return generateAvatar(avatarStore.cosImageUrl, style);\n          case 4:\n            res = _context.sent;\n            taskId = res.data.data; // 获取任务ID\n            // 存储任务ID\n            avatarStore.setTaskId(taskId);\n\n            // 跳转到结果页面\n            Taro.navigateTo({\n              url: \"/pages/result/index?taskId=\".concat(taskId)\n            });\n            _context.next = 13;\n            break;\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](0);\n            Taro.showToast({\n              title: '生成失败',\n              icon: 'none'\n            });\n          case 13:\n            _context.prev = 13;\n            setLoading(false);\n            return _context.finish(13);\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 10, 13, 16]]);\n    }));\n    return function handleSelect(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxs(View, {\n    className: \"style-page\",\n    children: [/*#__PURE__*/_jsx(View, {\n      className: \"title\",\n      children: \"\\u9009\\u62E9\\u98CE\\u683C\"\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"grid\",\n      children: styleMap.map(function (style) {\n        return /*#__PURE__*/_jsxs(View, {\n          className: \"style-card\",\n          onClick: function onClick() {\n            return !loading && handleSelect(style.name);\n          },\n          children: [/*#__PURE__*/_jsx(Image, {\n            className: \"icon\",\n            src: style.icon,\n            mode: \"aspectFit\"\n          }), /*#__PURE__*/_jsx(View, {\n            className: \"name\",\n            children: style.name\n          })]\n        }, style.name);\n      })\n    }), /*#__PURE__*/_jsxs(View, {\n      className: \"vip-section\",\n      children: [/*#__PURE__*/_jsxs(View, {\n        className: \"vip-title\",\n        children: [/*#__PURE__*/_jsx(Image, {\n          className: \"crown\",\n          src: iconCrown,\n          mode: \"aspectFit\"\n        }), /*#__PURE__*/_jsx(Text, {\n          children: \"\\u4F1A\\u5458\\u4E13\\u5C5E\\u98CE\\u683C\"\n        })]\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"grid\",\n        children: [/*#__PURE__*/_jsxs(View, {\n          className: \"vip-card\",\n          onClick: function onClick() {\n            return userStore.isVip && !loading && handleSelect('premium1');\n          },\n          children: [/*#__PURE__*/_jsx(Image, {\n            className: \"icon\",\n            src: iconStar,\n            mode: \"aspectFit\"\n          }), /*#__PURE__*/_jsx(View, {\n            className: \"name\",\n            children: \"\\u9AD8\\u7EA7\\u98CE\\u683C1\"\n          })]\n        }), /*#__PURE__*/_jsxs(View, {\n          className: \"vip-card\",\n          onClick: function onClick() {\n            return userStore.isVip && !loading && handleSelect('premium2');\n          },\n          children: [/*#__PURE__*/_jsx(Image, {\n            className: \"icon\",\n            src: iconStar,\n            mode: \"aspectFit\"\n          }), /*#__PURE__*/_jsx(View, {\n            className: \"name\",\n            children: \"\\u9AD8\\u7EA7\\u98CE\\u683C2\"\n          })]\n        })]\n      })]\n    })]\n  });\n}\nfunction showError(errorMessage) {\n  throw new Error('Function not implemented.');\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/style/index!./index.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pages/style/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}